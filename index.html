<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>AR.js Hiro Marker â€“ Multiple 3D Models</title>

  <!-- A-Frame -->
  <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>

  <!-- AR.js -->
  <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js/aframe/build/aframe-ar.js"></script>

  <style>
    body {
      margin: 0;
      overflow: hidden;
    }
  </style>
</head>

<body>

<a-scene
  embedded
  arjs="sourceType: webcam; debugUIEnabled: false;"
  vr-mode-ui="enabled: false"
  renderer="colorManagement: true;"
>

  <!-- ASSETS -->
  <a-assets>
    <a-asset-item id="m0" src="assets/object_0-2.glb"></a-asset-item>
    <a-asset-item id="m1" src="assets/object_1.glb"></a-asset-item>
    <a-asset-item id="m2" src="assets/object_2.glb"></a-asset-item>
    <a-asset-item id="m3" src="assets/object_3.glb"></a-asset-item>
    <a-asset-item id="m4" src="assets/object_3.glb"></a-asset-item>
  </a-assets>

  <!-- HIRO MARKER -->
  <a-marker preset="hiro">

    <!-- MODEL 0 (CENTER) -->
    <a-entity id="model0" gltf-model="#m0" position="0 0 0" scale="0.4 0.4 0.4"></a-entity>

    <!-- MODEL 1 -->
    <a-entity id="model1" gltf-model="#m1" position="-0.5 0 0" scale="0.3 0.3 0.3"></a-entity>

    <!-- MODEL 2 -->
    <a-entity id="model2" gltf-model="#m2" position="0.5 0 0" scale="0.3 0.3 0.3"></a-entity>

    <!-- MODEL 3 -->
    <a-entity id="model3" gltf-model="#m3" position="0 0 -0.5" scale="0.3 0.3 0.3"></a-entity>

    <!-- MODEL 4 -->
    <a-entity id="model4" gltf-model="#m4" position="0 0 0.5" scale="0.3 0.3 0.3"></a-entity>

  </a-marker>

  <a-entity camera></a-entity>
</a-scene>

<script>
  const modelIds = ["model0", "model1", "model2", "model3", "model4"];

  modelIds.forEach(id => {
    const el = document.getElementById(id);

    el.addEventListener("model-loaded", () => {
      const mesh = el.getObject3D("mesh");

      if (!mesh) return;

      mesh.traverse(node => {
        if (node.isMesh) {
          const oldMat = node.material;
          node.material = new THREE.MeshBasicMaterial({
            map: oldMat.map || null,
            color: oldMat.color || new THREE.Color(1, 1, 1)
          });
          node.material.needsUpdate = true;
        }
      });
    });
  });
</script>

</body>
</html>
